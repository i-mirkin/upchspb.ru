Order Deny,Allow
Deny from 92.53.96.117
#Deny from 188.242.138.53

Options -Indexes 
ErrorDocument 404 /404.php

php_value auto_prepend_file "/home/c/cg46529/public_html/bitrix/modules/security/tools/start.php"

<IfModule mod_rewrite.c>
  	Options +FollowSymLinks
  	RewriteEngine On
  
  	RewriteCond %{HTTP:X-Forwarded-Proto} !https
	RewriteRule ^(.*)$ https://%{SERVER_NAME}/$1 [R,L]
  
  	RewriteCond %{HTTP_HOST} ^www\.(.*) [NC]
  	RewriteRule ^(.*)$ https://%1/$1 [R=301,L]
  
  	RewriteRule ^index\.php$ / [R=301,L]
		
	#Redirect 301 /en/upolnomochennyy/apparat/ https://upchspb.ru/upolnomochennyy/apparat/
	#Redirect 301 /bitrix/admin/rubric_admin.php https://upchspb.ru/bitrix/admin/posting_admin.php
	
	
	RewriteCond %{REQUEST_URI} !\?
	RewriteCond %{REQUEST_URI} !\&
	RewriteCond %{REQUEST_URI} !\=
	RewriteCond %{REQUEST_URI} !\.
	RewriteCond %{REQUEST_URI} !\/$
	RewriteCond %{SERVER_NAME} ^www\.(.*)$
	RewriteRule ^(.*)$ https://%1/$1/ [L,R=301]
	 
	RewriteCond %{REQUEST_URI} !\?
	RewriteCond %{REQUEST_URI} !\&
	RewriteCond %{REQUEST_URI} !\=
	RewriteCond %{REQUEST_URI} !\.
	RewriteCond %{REQUEST_URI} ![^\/]$
	RewriteCond %{SERVER_NAME} ^www\.(.*)$
	RewriteRule ^(.*)$ https://%1/$1 [L,R=301]
	 
	RewriteCond %{REQUEST_URI} !\?
	RewriteCond %{REQUEST_URI} !\&
	RewriteCond %{REQUEST_URI} !\=
	RewriteCond %{REQUEST_URI} !\.
	RewriteCond %{REQUEST_URI} !\/$
	RewriteCond %{SERVER_NAME} ^([^www].*)$
	RewriteRule ^(.*)$ https://%1/$1/ [L,R=301]
  
  	#RewriteCond %{REQUEST_URI} !\?
	#RewriteCond %{REQUEST_URI} !\&
	#RewriteCond %{REQUEST_URI} !\=
	#RewriteCond %{REQUEST_URI} !\.
	#RewriteCond %{REQUEST_URI} !\/$
	#RewriteCond %{SERVER_NAME} ^([^www].*)$
	#RewriteRule ^(.*)$ https://%1/$1/ [L,R=301]
	
  
 # RewriteCond %{HTTP_HOST} ^www\.(.*) [NC]
 # RewriteRule ^(.*)$ https://%1/$1 [R=301,L]
  
 # RewriteCond %{REQUEST_FILENAME} !-f
 # RewriteCond %{REQUEST_FILENAME} !-l
 # RewriteCond %{REQUEST_FILENAME} !-d
 # RewriteCond %{REQUEST_URI} ^(.*/[^/\.]+)$
 # RewriteRule ^(.*)$ https://%{HTTP_HOST}/$1/ [R=301,L]
  
	RewriteCond %{REQUEST_FILENAME} !-f
	RewriteCond %{REQUEST_FILENAME} !-l
	RewriteCond %{REQUEST_FILENAME} !-d
	RewriteCond %{REQUEST_FILENAME} !/bitrix/urlrewrite.php$
	RewriteRule ^(.*)$ /bitrix/urlrewrite.php [L]
	RewriteRule .* - [E=REMOTE_USER:%{HTTP:Authorization}]
</IfModule>

<IfModule mod_dir.c>
  DirectoryIndex index.php index.html
</IfModule>

<filesMatch ".(jpg|jpeg|gif|png|svg|js|css|mp3|ogg|mpe?g|avi|zip|gz|bz2?|rar|swf|woff|eot|ttf|pdf|mp4|exe|doc|html|flv|ico|xml|txt|css|ogg|ogv|svg|svgz|eot|otf|woff2|mp4|ttf|rss|atom|jpg|jpeg|gif|png|ico|zip|tgz|gz|rar|bz2|doc|xls|exe|ppt|tar|mid|midi|wav|bmp|rtf)$">
 Header set Cache-Control "max-age=31557600, public"
</filesMatch>

<filesMatch ".(css|js)$">
 Header set Cache-Control "max-age=31557600, public"
</filesMatch>

<IfModule mod_expires.c>
  ExpiresActive On

  # Images
  ExpiresByType image/jpg "access plus 1 year"
  ExpiresByType image/jpeg "access plus 1 year"
  ExpiresByType image/gif "access plus 1 year"
  ExpiresByType image/png "access plus 1 year"
  ExpiresByType image/webp "access plus 1 year"
  ExpiresByType image/svg+xml "access plus 1 year" 
  ExpiresByType image/x-icon "access plus 1 year"

  # Video
  ExpiresByType video/mp4 "access plus 1 year"
  ExpiresByType video/mpeg "access plus 1 year"

  # CSS, JavaScript
  ExpiresByType text/css "access plus 1 year"
  ExpiresByType text/javascript "access plus 1 year"
  ExpiresByType application/javascript "access plus 1 year"

  # Others
  ExpiresByType application/pdf "access plus 1 year"
  ExpiresByType application/x-shockwave-flash "access plus 1 year"
</IfModule>

<IfModule mod_deflate.c>
  AddOutputFilterByType DEFLATE text/html
  AddOutputFilterByType DEFLATE text/css
  AddOutputFilterByType DEFLATE text/javascript
  AddOutputFilterByType DEFLATE text/xml
  AddOutputFilterByType DEFLATE text/plain
  AddOutputFilterByType DEFLATE image/x-icon
  AddOutputFilterByType DEFLATE image/svg+xml
  AddOutputFilterByType DEFLATE application/rss+xml
  AddOutputFilterByType DEFLATE application/javascript
  AddOutputFilterByType DEFLATE application/x-javascript
  AddOutputFilterByType DEFLATE application/xml
  AddOutputFilterByType DEFLATE application/xhtml+xml 
  AddOutputFilterByType DEFLATE application/x-font  
  AddOutputFilterByType DEFLATE application/x-font-truetype  
  AddOutputFilterByType DEFLATE application/x-font-ttf  
  AddOutputFilterByType DEFLATE application/x-font-otf 
  AddOutputFilterByType DEFLATE application/x-font-opentype 
  AddOutputFilterByType DEFLATE application/vnd.ms-fontobject
  AddOutputFilterByType DEFLATE font/ttf 
  AddOutputFilterByType DEFLATE font/otf 
  AddOutputFilterByType DEFLATE font/opentype
# For Older Browsers Which Can't Handle Compression
  BrowserMatch ^Mozilla/4 gzip-only-text/html 
  BrowserMatch ^Mozilla/4\.0[678] no-gzip
  BrowserMatch \bMSIE !no-gzip !gzip-only-text/html
</IfModule>

<ifModule mod_gzip.c>
  mod_gzip_on Yes
  mod_gzip_dechunk Yes
  mod_gzip_item_include file \.(html?|txt|css|js|php|pl)$
  mod_gzip_item_include mime ^application/x-javascript.*
  mod_gzip_item_include mime ^text/.*
  mod_gzip_item_exclude rspheader ^Content-Encoding:.*gzip.*
  mod_gzip_item_exclude mime ^image/.* 
  mod_gzip_item_include handler ^cgi-script$
</ifModule>
